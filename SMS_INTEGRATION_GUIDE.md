# ุฏููู ุชูุงูู ุฎุฏูุฉ TweetSMS API

## ูุธุฑุฉ ุนุงูุฉ

ุชู ุชูุงูู ุฎุฏูุฉ TweetSMS ุจูุฌุงุญ ูุน ุงููุธุงู ุจุงุณุชุฎุฏุงู **API Key ููุท** ููุง ูู ููุถุญ ูู ูุซุงุฆู TweetSMS. ุงููุธุงู ูุฏุนู ุฅุฑุณุงู ุฑุณุงุฆู SMSุ ุงูุชุญูู ูู ุงูุฃุฑูุงู ุนุจุฑ OTPุ ููุชุงุจุนุฉ ุงูุฑุตูุฏ ูุงูุฅุญุตุงุฆูุงุช.

---

## ๐ ุงููุชุทูุจุงุช

ููุจุฏุก ูู ุงุณุชุฎุฏุงู ุฎุฏูุฉ SMSุ ุชุญุชุงุฌ ุฅูู:

1. **API Key** ูู ุญุณุงุจ TweetSMS ุงูุฎุงุต ุจู
2. **ุงุณู ุงููุฑุณู (Sender Name)** ุงููุนุชูุฏ ูู ุญุณุงุจู

---

## ๐ ุงูููููุงุช ุงููุถุงูุฉ

### 1. ูุงุนุฏุฉ ุงูุจูุงูุงุช

ุชู ุฅุถุงูุฉ ุงูุฌุฏุงูู ุงูุชุงููุฉ:

#### `sms_api_settings`
ูุญูุธ ุฅุนุฏุงุฏุงุช ุงูุงุชุตุงู ุจุฎุฏูุฉ TweetSMS:
- `api_key_encrypted`: ููุชุงุญ API ูุดูุฑ
- `sender_name`: ุงุณู ุงููุฑุณู
- `api_url`: ุฑุงุจุท API (ุงูุชุฑุงุถู: https://tweetsms.ps/api.php/maan)
- `max_daily_limit`: ุงูุญุฏ ุงูุฃูุตู ููุฑุณุงุฆู ุงูููููุฉ
- `low_balance_threshold`: ุญุฏ ุงูุชูุจูู ุนูุฏ ุงูุฎูุงุถ ุงูุฑุตูุฏ
- `last_balance_amount`: ุขุฎุฑ ุฑุตูุฏ ุชู ูุญุตู

#### `sms_logs`
ุณุฌู ูุงูู ูุฌููุน ุงูุฑุณุงุฆู ุงููุฑุณูุฉ:
- ูุนูููุงุช ุงูุฑุณุงูุฉ (ุงูุฑููุ ุงููุตุ ุงูููุน)
- ุญุงูุฉ ุงูุฅุฑุณุงู (pending, sent, failed)
- ุฑูู ุงูุฑุณุงูุฉ ูู TweetSMS (SMS_ID)
- ุฑูุฒ ุงููุชูุฌุฉ ูุฃู ุฑุณุงุฆู ุฎุทุฃ
- ุฑุจุท ุจุงููุณุชููุฏ ูุงูุทุฑุฏ ุฅู ูุฌุฏ

#### `verification_codes`
ุฅุฏุงุฑุฉ ุฑููุฒ ุงูุชุญูู OTP:
- ุฑูุฒ ุงูุชุญูู ุงููููู ูู 6 ุฃุฑูุงู
- ุฑูู ุงููุงุชู
- ุชุงุฑูุฎ ุงูุงูุชูุงุก (5 ุฏูุงุฆู)
- ุนุฏุฏ ุงููุญุงููุงุช (ุญุฏ ุฃูุตู 5)
- ุญุงูุฉ ุงูุงุณุชุฎุฏุงู

### 2. ุงูุฎุฏูุงุช (Services)

#### `smsService.ts`
ุฎุฏูุฉ ุดุงููุฉ ุชุชุถูู:

**ุฏูุงู ุงูุฅุฑุณุงู:**
- `sendSMS()`: ุฅุฑุณุงู ุฑุณุงูุฉ SMS ุนุงุฏูุฉ
- `sendOTP()`: ุฅุฑุณุงู ุฑูุฒ ุชุญูู OTP
- `verifyOTP()`: ุงูุชุญูู ูู ุตุญุฉ ุฑูุฒ OTP

**ุฏูุงู ุงูุฅุฏุงุฑุฉ:**
- `checkBalance()`: ูุญุต ุงูุฑุตูุฏ ุงููุชุจูู
- `getSettings()`: ุฌูุจ ุฅุนุฏุงุฏุงุช SMS
- `saveSettings()`: ุญูุธ ุงูุฅุนุฏุงุฏุงุช ูุน ุงูุชุดููุฑ

**ุฏูุงู ูุณุงุนุฏุฉ:**
- `formatPhoneNumber()`: ุชูุณูู ุฃุฑูุงู ุงูููุงุชู ุงูููุณุทูููุฉ
- `validatePhoneNumber()`: ุงูุชุญูู ูู ุตุญุฉ ุฑูู ุงููุงุชู
- `generateOTPCode()`: ุชูููุฏ ุฑูุฒ OTP ุนุดูุงุฆู
- `encrypt()` / `decrypt()`: ุชุดููุฑ ููู ุชุดููุฑ ุงูุจูุงูุงุช ุงูุญุณุงุณุฉ

**ุฅุญุตุงุฆูุงุช:**
- `getSMSLogs()`: ุฌูุจ ุณุฌู ุงูุฑุณุงุฆู ูุน ููุงุชุฑ
- `getSMSStatistics()`: ุฅุญุตุงุฆูุงุช ุดุงููุฉ ููุงุณุชุฎุฏุงู

### 3. ุงููุงุฌูุงุช (Components)

#### `SMSSettingsPage.tsx`
ุตูุญุฉ ุฅุนุฏุงุฏุงุช SMS ุงูุดุงููุฉ ุจู 4 ุชุจููุจุงุช:

**ุชุจููุจ "ุฅุนุฏุงุฏุงุช ุงูุงุชุตุงู":**
- ุฅุฏุฎุงู API Key ูุดูุฑ
- ุฅุฏุฎุงู ุงุณู ุงููุฑุณู
- ุชุญุฏูุฏ ุงูุญุฏ ุงูุฃูุตู ุงููููู
- ุนุฑุถ ุงูุฑุตูุฏ ุงูุญุงูู
- ุฒุฑ ูุญุต ุงูุฑุตูุฏ

**ุชุจููุจ "ุชุฌุฑุจุฉ ุงูุฎุฏูุฉ":**
- ุฅุฑุณุงู ุฑุณุงูุฉ ุชุฌุฑูุจูุฉ
- ุฅุฏุฎุงู ุฑูู ุงููุงุชู
- ูุชุงุจุฉ ูุต ุงูุฑุณุงูุฉ
- ุนุฑุถ ูุชูุฌุฉ ุงูุฅุฑุณุงู (SMS_ID ุฃู ุฑุณุงูุฉ ุงูุฎุทุฃ)

**ุชุจููุจ "ุณุฌู ุงูุฑุณุงุฆู":**
- ุนุฑุถ ุขุฎุฑ 20 ุฑุณุงูุฉ
- ุชุตููุฉ ุญุณุจ ุงูุญุงูุฉ ูุงูููุน
- ุงูุชููู ุจูู ุงูุตูุญุงุช
- ุนุฑุถ ุชูุงุตูู ูู ุฑุณุงูุฉ

**ุชุจููุจ "ุงูุฅุญุตุงุฆูุงุช":**
- ุฅุฌูุงูู ุงูุฑุณุงุฆู ุงููุฑุณูุฉ
- ุนุฏุฏ ุงูุฑุณุงุฆู ุงููุงุฌุญุฉ
- ุนุฏุฏ ุงูุฑุณุงุฆู ุงููุงุดูุฉ
- ูุนุฏู ุงููุฌุงุญ ุจุงููุณุจุฉ ุงููุฆููุฉ

#### `OTPVerificationModal.tsx`
ูุงูุฐุฉ ููุจุซูุฉ ููุชุญูู ูู OTP:
- 6 ุญููู ูุฅุฏุฎุงู ุฑูุฒ ุงูุชุญูู
- ุฏุนู ุงููุตู ุงููุจุงุดุฑ
- ุนุฏุงุฏ ุชูุงุฒูู 5 ุฏูุงุฆู
- ุฅููุงููุฉ ุฅุนุงุฏุฉ ุงูุฅุฑุณุงู
- ุชุญูู ุชููุงุฆู ุนูุฏ ุฅุฏุฎุงู ุงูุฑูุฒ ูุงููุงู

---

## ๐ ููููุฉ ุงูุงุณุชุฎุฏุงู

### 1. ุชูุนูู ุงูุฎุฏูุฉ

1. ุงูุชูู ุฅูู: **ุงูุฅุนุฏุงุฏุงุช** โ **ุฅุนุฏุงุฏุงุช SMS**
2. ุงููุฑ ุนูู ุชุจููุจ **"ุฅุนุฏุงุฏุงุช ุงูุงุชุตุงู"**
3. ุฃุฏุฎู **API Key** ูู ุญุณุงุจ TweetSMS
4. ุฃุฏุฎู **ุงุณู ุงููุฑุณู** ุงููุนุชูุฏ
5. ุงููุฑ ุนูู **"ุญูุธ ุงูุฅุนุฏุงุฏุงุช"**
6. ุงููุฑ ุนูู **"ูุญุต ุงูุฑุตูุฏ"** ููุชุฃูุฏ ูู ุงูุงุชุตุงู

### 2. ุงุฎุชุจุงุฑ ุงูุฅุฑุณุงู

1. ุงูุชูู ุฅูู ุชุจููุจ **"ุชุฌุฑุจุฉ ุงูุฎุฏูุฉ"**
2. ุฃุฏุฎู ุฑูู ูุงุชู ุตุญูุญ (ูุซุงู: 0599123456)
3. ุงูุชุจ ุฑุณุงูุฉ ุชุฌุฑูุจูุฉ
4. ุงููุฑ ุนูู **"ุฅุฑุณุงู ุฑุณุงูุฉ ุชุฌุฑูุจูุฉ"**
5. ุณุชุธูุฑ ุงููุชูุฌุฉ ูุน SMS_ID ุฅุฐุง ูุฌุญ ุงูุฅุฑุณุงู

### 3. ุงุณุชุฎุฏุงู OTP ูู ุงูุชุณุฌูู

ูุงุณุชุฎุฏุงู ุงูุชุญูู ุนุจุฑ OTP ูู ุฃู ููุงู ูู ุงูุชุทุจูู:

```typescript
import OTPVerificationModal from './components/OTPVerificationModal';

// ูู ุงููููู ุงูุฎุงุต ุจู
const [showOTPModal, setShowOTPModal] = useState(false);

// ุนูุฏ ุงูุญุงุฌุฉ ููุชุญูู
<OTPVerificationModal
  isOpen={showOTPModal}
  onClose={() => setShowOTPModal(false)}
  phoneNumber="0599123456"
  beneficiaryName="ุฃุญูุฏ ูุญูุฏ"
  beneficiaryId="uuid-here"
  verificationType="registration"
  onVerificationSuccess={(beneficiaryId) => {
    console.log('ุชู ุงูุชุญูู ุจูุฌุงุญ!', beneficiaryId);
    // ุชุงุจุน ุนูููุฉ ุงูุชุณุฌูู
  }}
  onVerificationFail={(error) => {
    console.error('ูุดู ุงูุชุญูู:', error);
  }}
/>
```

---

## ๐ ุงูุฃูุงู

### ุงูุชุดููุฑ
- ุฌููุน ุงูุจูุงูุงุช ุงูุญุณุงุณุฉ (API Key) ูุชู ุชุดููุฑูุง ูุจู ุงูุญูุธ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
- ุงุณุชุฎุฏุงู Web Crypto API ููุชุดููุฑ
- ุนุฏู ุชุฎุฒูู ุฃู ุจูุงูุงุช ุญุณุงุณุฉ ูู plain text

### Row Level Security (RLS)
- ุฌููุน ุงูุฌุฏุงูู ูุญููุฉ ุจุณูุงุณุงุช RLS
- ููุท ุงููุณุชุฎุฏููู ุงููุตุฑุญ ููู ูููููู ุงููุตูู ููุฅุนุฏุงุฏุงุช
- ุณุฌู ูุงูู ูุฌููุน ุงูุนูููุงุช ูู `activity_log`

### ูุนุงูุฌุฉ ุงูุฃุฎุทุงุก
ุงููุธุงู ูุชุนุงูู ูุน ุฌููุน ุฃููุงุฏ ุงูุฃุฎุทุงุก ูู TweetSMS:

| ุงูููุฏ | ุงููุนูู |
|------|---------|
| 999 | ูุฌุงุญ ุงูุฅุฑุณุงู |
| -100 | ูุนููุงุช ูุงูุตุฉ |
| -110 | API Key ุฎุงุทุฆ |
| -113 | ุฑุตูุฏ ุบูุฑ ูุงูู |
| -115 | ุงุณู ุงููุฑุณู ุบูุฑ ูุชุงุญ |
| -116 | ุงุณู ูุฑุณู ุบูุฑ ุตุงูุญ |
| -2 | ุฑูู ุบูุฑ ุตุงูุญ |
| -999 | ูุดู ูู ูุฒูุฏ ุงูุฎุฏูุฉ |

---

## ๐ ุงูุฅุญุตุงุฆูุงุช ูุงูุชูุงุฑูุฑ

### ุนุฑุถ ุงูุฅุญุตุงุฆูุงุช
ููููู ุนุฑุถ ุฅุญุตุงุฆูุงุช ููุตูุฉ ูู ุชุจููุจ "ุงูุฅุญุตุงุฆูุงุช":
- ุฅุญุตุงุฆูุงุช ุขุฎุฑ 7ุ 30ุ ุฃู 90 ููู
- ูุนุฏู ุงููุฌุงุญ/ุงููุดู
- ุชูุฒูุน ุงูุฑุณุงุฆู ุญุณุจ ุงูููุน

### ุณุฌู ุงูุฑุณุงุฆู
ุณุฌู ูุงูู ููู ุฑุณุงูุฉ ูุน:
- ุฑูู ุงููุงุชู
- ูุต ุงูุฑุณุงูุฉ
- ุญุงูุฉ ุงูุฅุฑุณุงู
- ุฑูุฒ ุงููุชูุฌุฉ
- ุงูุชุงุฑูุฎ ูุงูููุช
- ุฑุงุจุท ุจุงููุณุชููุฏ ุฅู ูุฌุฏ

---

## ๐ง API Endpoints ุงููุณุชุฎุฏูุฉ

### ุฅุฑุณุงู ุฑุณุงูุฉ
```
POST https://tweetsms.ps/api.php/maan/sendsms
Content-Type: application/x-www-form-urlencoded

api_key={YOUR_API_KEY}
name={SENDER_NAME}
mobile={PHONE_NUMBER}
message={MESSAGE_TEXT}
```

### ูุญุต ุงูุฑุตูุฏ
```
POST https://tweetsms.ps/api.php/maan/balance
Content-Type: application/x-www-form-urlencoded

api_key={YOUR_API_KEY}
```

---

## ๐ฑ ุชูุณูู ุฃุฑูุงู ุงูููุงุชู

ุงููุธุงู ูุฏุนู ุฌููุน ุงูุตูุบ ุงูุชุงููุฉ ููุญูููุง ุชููุงุฆูุงู:
- `0599123456` โ `972599123456`
- `599123456` โ `972599123456`
- `+972599123456` โ `972599123456`
- `972599123456` โ `972599123456` (ุจุฏูู ุชุบููุฑ)

---

## โ๏ธ ุงูุฅุนุฏุงุฏุงุช ุงููุชูุฏูุฉ

### ุงูุญุฏ ุงููููู
- ููููู ุชุญุฏูุฏ ุญุฏ ุฃูุตู ููุฑุณุงุฆู ุงููุฑุณูุฉ ููููุงู
- ูุชู ุฅุนุงุฏุฉ ุชุนููู ุงูุนุฏุงุฏ ุชููุงุฆูุงู ูู ููู
- ุงูุงูุชุฑุงุถู: 1000 ุฑุณุงูุฉ/ููู

### ุชูุจูู ุงูุฑุตูุฏ ุงูููุฎูุถ
- ุชูุนูู/ุชุนุทูู ุชูุจููุงุช ุงูุฑุตูุฏ ุงูููุฎูุถ
- ุชุญุฏูุฏ ุญุฏ ุงูุชูุจูู (ุงูุงูุชุฑุงุถู: 100 ุฑุณุงูุฉ)

---

## ๐ ุงุณุชูุดุงู ุงูุฃุฎุทุงุก

### "SMS service not configured"
- ุชุฃูุฏ ูู ุญูุธ ุงูุฅุนุฏุงุฏุงุช
- ุชุฃูุฏ ูู ุชูุนูู ุงูุฎุฏูุฉ ูู ุงูุฅุนุฏุงุฏุงุช

### "Wrong API Key"
- ุชุญูู ูู API Key ูู ุญุณุงุจ TweetSMS
- ุชุฃูุฏ ูู ูุณุฎู ุจุงููุงูู ุฏูู ูุณุงูุงุช

### "Not enough balance"
- ุงูุญุต ุฑุตูุฏู ูู ุญุณุงุจ TweetSMS
- ุฃุนุฏ ุดุญู ุงูุญุณุงุจ

### "Invalid phone number"
- ุชุฃูุฏ ูู ุตูุบุฉ ุงูุฑูู ุงูููุณุทููู
- ูุฌุจ ุฃู ูุจุฏุฃ ุจู 05 ุฃู 9725

---

## ๐ ููุงุญุธุงุช ูููุฉ

1. **API Key ูู ุงููุทููุจ ููุท** - ูุง ุญุงุฌุฉ ูู username ู password
2. **ุงูุชุดููุฑ ุชููุงุฆู** - ูุชู ุชุดููุฑ API Key ูุจู ุงูุญูุธ
3. **OTP ุตุงูุญ ูู 5 ุฏูุงุฆู** - ุจุนุฏูุง ูุฌุจ ุทูุจ ุฑูุฒ ุฌุฏูุฏ
4. **ุญุฏ ุฃูุตู 5 ูุญุงููุงุช** - ููู ุฑูุฒ OTP
5. **ุงูุณุฌูุงุช ูุญููุธุฉ** - ุฌููุน ุงูุฑุณุงุฆู ูุณุฌูุฉ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช

---

## โ ุงูุฎูุงุตุฉ

ุงููุธุงู ุฌุงูุฒ ุชูุงูุงู ููุงุณุชุฎุฏุงู! ููููู ุงูุขู:
- โ ุฅุฑุณุงู ุฑุณุงุฆู SMS ุนุงุฏูุฉ
- โ ุฅุฑุณุงู ุฑููุฒ ุชุญูู OTP
- โ ุงูุชุญูู ูู ุฃุฑูุงู ุงูููุงุชู
- โ ูุชุงุจุนุฉ ุงูุฑุตูุฏ ูุงูุฅุญุตุงุฆูุงุช
- โ ุนุฑุถ ุณุฌู ูุงูู ููุฑุณุงุฆู
- โ ุงุฎุชุจุงุฑ ุงูุฎุฏูุฉ ูุจู ุงูุงุณุชุฎุฏุงู ุงููุนูู

ูุฃู ุงุณุชูุณุงุฑุงุช ุฃู ูุดุงููุ ุฑุงุฌุน ูุณู "ุงุณุชูุดุงู ุงูุฃุฎุทุงุก" ุฃู ุชูุงุตู ูุน ูุฑูู ุงูุฏุนู ุงูููู.
